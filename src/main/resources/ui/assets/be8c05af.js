import{B as R,R as N,j as e,u as y,r as o,c as P,E as v}from"./3f2d47e7.js";/* empty css        */import{I as A,H as C,L as F,E as c}from"./0e2defe6.js";import{q as I}from"./4a98f407.js";class S extends R{constructor(r){super(N.POST,"/api/methods/auth.resetPassword",r,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}})}}const T=()=>{const l=y(),[r,x]=o.useState(void 0),[h,f]=o.useState(!1),[i,j]=o.useState(""),[p,t]=o.useState(void 0),E=a=>{const d=a.currentTarget.value.trim();j(d),t(void 0)};async function g(){const a=I(i);if(a){t(a);return}new S({username:i}).execute().then(s=>{if(s.data.ok)x(s.data.email);else throw c.INTERNAL_ERROR}).catch(s=>{var m;if(!(s.response&&s.response.data)){l.show.internalError();return}const n=s.response.data;n.type===c.BAD_REQUEST_PARAMETERS?(m=n.parameters)==null||m.forEach(w=>{w==="username"&&t("Invalid")}):n.type===c.EMAIL_NOT_CONFIRMED?f(!0):n.type===c.USERNAME_UNOCCUPIED?t("Account doesn't exist"):l.show.internalError()})}return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full xs:w-xs p-4 space-y-8",children:[e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"text-3xl font-medium",children:"Account recovery"})}),h?e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"text-red-500",children:"Sorry, we can't recover your account because you didn't confirm your email."})})}):e.jsx(e.Fragment,{children:r?e.jsx(e.Fragment,{children:e.jsx("div",{children:e.jsxs("span",{children:["New password sent to ",e.jsx("span",{className:"font-semibold",children:r})]})})}):e.jsxs(e.Fragment,{children:[e.jsx(A,{placeholder:"Username",autoFocus:!0,value:i,onChange:E,errorMessage:p}),e.jsx("button",{className:"btn-dark w-full text-xl",onClick:g,children:"Reset password"})]})})]})})},U=()=>e.jsxs(C,{children:[e.jsx("a",{className:"flex h-full items-center font-logo text-3xl",href:"/",children:e.jsx(F,{})}),e.jsx("div",{className:"h-full flex justify-end items-center",children:e.jsx("a",{className:"btn-dark-outline",href:"/login",children:"Log In"})})]}),M=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(U,{}),e.jsx("main",{className:"flex flex-col justify-center items-center grow",children:e.jsx(T,{})})]})}),L=()=>e.jsx(e.Fragment,{children:e.jsx(v,{children:e.jsx(M,{})})}),u=document.getElementById("p-reset-password");u&&P(u).render(e.jsx(L,{}));
