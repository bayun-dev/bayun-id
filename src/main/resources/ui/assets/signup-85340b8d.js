import{a as S,u as H,r as a,j as e,l as Y,O as D,B as I,R as U,b as W,i as _,c as b,d as C,I as y,e as k,f as P,C as z,g as J,h as K,k as Q,L as X}from"./Checkbox-429e4bcf.js";import{L as O}from"./Link-dd234871.js";import{v as Z,S as $,I as ee,a as te,b as re,c as se,d as ae,e as ne,f as oe,h as ie}from"./moment-40189d43.js";const le={"/signup":"/signup/person","/signup/person":"/signup/contact","/signup/contact":"/signup/secret","/signup/secret":"/login"},ce=()=>{const r=S(),n=H(),t=()=>le[n.pathname],[l,m]=a.useState(""),[c,h]=a.useState(""),[f,x]=a.useState(""),[g,p]=a.useState(new Date),[d,j]=a.useState("male"),[o,v]=a.useState(void 0),u={username:l,setUsername:m,firstName:c,setFirstName:h,lastName:f,setLastName:x,dateOfBirth:g,setDateOfBirth:p,gender:d,setGender:j,email:o,setEmail:v,getNextUrl:t};return a.useEffect(()=>{l.trim().length===0&&n.pathname!=="/signup"&&r("/signup")},[l]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col justify-center sm:items-center min-h-full bg-gray-50 gap-6",children:[e.jsxs("a",{className:"flex items-center gap-2 font-logo text-3xl",href:"/",children:[e.jsx("img",{className:"w-8 h-8",src:Y,alt:""}),e.jsx("span",{children:"bayun"})]}),e.jsx("div",{className:"w-full sm:w-fit bg-white sm:rounded-lg sm:shadow",children:e.jsx("div",{className:"w-96 p-8 mx-auto",children:e.jsx(D,{context:u})})}),e.jsx("div",{className:"text-center",children:e.jsxs("span",{className:"text-gray-400 text-base",children:["Already have Bayun ID? ",e.jsx(O,{href:"/login",children:"Log In"})]})})]})})};class de extends I{constructor(n){super(U.POST,"/api/signup/availability",n,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}const M=a.createContext(void 0),ue=r=>{const[n,t]=a.useState(!1),[l,m]=a.useState(void 0),c=()=>{t(!0),m(e.jsx(q,{}))};return e.jsx(M.Provider,{value:{oops:c},children:n?e.jsx(T,{children:l}):r.children})},me=()=>{const r=W();return e.jsx(e.Fragment,{children:e.jsx(T,{children:_(r)&&r.status===404?e.jsx(xe,{}):e.jsx(q,{})})})},T=r=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 min-h-screen flex flex-col w-full justify-center items-center text-center py-8 px-4",children:r.children})}),xe=()=>e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"mb-4 text-7xl tracking-tight font-extrabold lg:text-9xl text-blue-600 dark:text-primary-500",children:"404"}),e.jsx("p",{className:"mb-4 text-3xl tracking-tight font-bold text-gray-900 md:text-4xl dark:text-white",children:"Something's missing."}),e.jsxs("p",{className:"mb-4 text-lg font-light text-gray-500 dark:text-gray-400",children:["Sorry, we can't find that page.",e.jsx("br",{}),e.jsx(O,{href:"/signup",children:"Back to sign up"})]})]}),q=()=>e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"mb-4 text-7xl tracking-tight font-extrabold lg:text-9xl text-blue-600 dark:text-primary-500",children:"OOPS"}),e.jsx("p",{className:"mb-4 text-3xl tracking-tight font-bold text-gray-900 md:text-4xl dark:text-white",children:"Look likes, somethings went wrong."}),e.jsxs("p",{className:"mb-4 text-lg font-light text-gray-500 dark:text-gray-400",children:["We are already working to solve the problem.",e.jsx("br",{}),e.jsx(O,{href:"/signup",children:"Back to sign up"})]})]}),A=()=>{const r=a.useContext(M);if(!r)throw new Error("No SignupErrorProvider not found when calling useSignupError.");return r},he=()=>{const r=b(),n=S(),t=C(),l=A(),[m,c]=a.useState(void 0),[h,f]=a.useState(void 0),x=p=>{let d=p.currentTarget.value;d&&(d=d.trim()),t.setUsername(d),c(void 0)},g=async()=>{r.show();const p=t.username.trim(),d=Z(p);if(d.error){c(d.error),f(d.help),r.hide();return}new de({username:p}).execute().then(o=>{if(o.status===200)o.data.available?n(t.getNextUrl()):c("This username is already taken"),r.hide();else throw new Error},o=>{var v,u;if(o.response.data.errors){const N=(u=(v=o==null?void 0:o.response)==null?void 0:v.data)==null?void 0:u.errors;for(let w of N)switch(w.code){case P.USERNAME_INVALID:c("invalid username");break;default:throw new Error}r.hide()}else throw new Error}).catch(o=>{l.oops(),r.hide()})};return e.jsx(e.Fragment,{children:e.jsxs("main",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{children:e.jsx("span",{className:"text-2xl font-semibold",children:"Sign up"})}),e.jsx("div",{children:e.jsx("span",{className:"text-base text-gray-400",children:"enter your new username"})})]}),e.jsx(y,{placeholder:"Username",errorMessage:m,value:t.username,onChange:x,autoFocus:!0,children:h}),e.jsx(k,{type:"dark",onClick:g,children:"Next"})]})})},ge=()=>{const r=b(),n=S(),t=C(),[l,m]=a.useState(void 0),[c,h]=a.useState(void 0),[f,x]=a.useState(void 0),[g,p]=a.useState(void 0),[d,j]=a.useState(void 0),o=i=>{let s=i.currentTarget.value;s&&(s=s.trim()),t.setFirstName(s),m(void 0)},v=i=>{let s=i.currentTarget.value;s&&(s=s.trim()),t.setLastName(s),h(void 0)},u=i=>{i!=null&&t.setDateOfBirth(i)};function N(i){let s=i.target.value;s&&(s=s.trim()),t.setGender(s),p(void 0)}const w=()=>{r.show();const i=t.firstName.trim(),s=te(i);s.error&&(m(s.error),s.help&&j(s.help));const R=t.lastName.trim(),E=re(R);E.error&&(h(E.error),E.help&&j(E.help));const G=t.dateOfBirth,V=ae(),B=t.gender.trim(),F=se(B);if(F.error&&p(F.error),s.error||E.error||V.error||F.error){r.hide();return}t.setFirstName(i),t.setLastName(R),t.setDateOfBirth(G),t.setGender(B),n(t.getNextUrl()),r.hide()};return a.useEffect(()=>{console.log("gender",t.gender)},[t.gender]),e.jsx(e.Fragment,{children:e.jsxs("main",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{children:e.jsx("span",{className:"text-2xl font-semibold",children:"Sign up"})}),e.jsx("div",{children:e.jsx("span",{className:"text-base text-gray-400",children:"enter your personal data"})})]}),e.jsx(y,{placeholder:"First name",errorMessage:l,value:t.firstName,onChange:o,autoFocus:!0}),e.jsx(y,{placeholder:"Last name",errorMessage:c,value:t.lastName,onChange:v,children:d}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx($,{label:"Gender",values:{male:"Male",female:"Female"},value:t.gender,onChange:N,errorMessage:g}),e.jsx(ee,{label:"Date of birth",placeholder:"dd.mm.yyyy",errorMessage:f,selected:t.dateOfBirth,onChange:i=>u(i)})]}),e.jsx(k,{type:"dark",onClick:w,children:"Next"})]})})},pe=()=>{const r=b(),n=S(),t=C(),[l,m]=a.useState(void 0);function c(f){let x=f.currentTarget.value;x&&(x=x.trim()),t.setEmail(x),m(void 0)}const h=()=>{if(r.show(),t.email===void 0||t.email.trim().length===0)t.setEmail(void 0);else{const x=t.email,g=ne(x);if(g.error){m(g.error),r.hide();return}}n(t.getNextUrl()),r.hide()};return e.jsx(e.Fragment,{children:e.jsxs("main",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{children:e.jsx("span",{className:"text-2xl font-semibold",children:"Sign up"})}),e.jsx("div",{children:e.jsx("span",{className:"text-base text-gray-400",children:"enter your contact data"})})]}),e.jsx(y,{label:"Email",placeholder:"mail@example.com",errorMessage:l,value:t.email,onChange:c,autoFocus:!0,children:"Email is required for account recovery."}),e.jsx(k,{type:"dark",onClick:h,children:"Next"})]})})};class fe extends I{constructor(n){super(U.POST,"/api/signup",n,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}const je=()=>{const r=b(),n=C(),t=A(),[l,m]=a.useState(""),[c,h]=a.useState(void 0),[f,x]=a.useState(void 0),[g,p]=a.useState(!1);function d(o){m(o.currentTarget.value),h(void 0)}const j=()=>{r.show();const o=oe(l);if(o.error){h(o.error),o.help&&x(o.help),r.hide();return}new fe({username:n.username,firstName:n.firstName,lastName:n.lastName,dateOfBirth:ie(n.dateOfBirth).format("DD.MM.YYYY"),gender:n.gender,email:n.email,password:l}).execute().then(u=>{if(u.status===200)window.location.replace(n.getNextUrl()),r.hide();else throw new Error},u=>{var N,w;if(u.response.data.errors){const i=(w=(N=u==null?void 0:u.response)==null?void 0:N.data)==null?void 0:w.errors;if(i.some(s=>s.code!==P.PASSWORD_INVALID))throw new Error;i.some(s=>s.code===P.PASSWORD_INVALID)&&h("invalid password"),r.hide()}else throw new Error}).catch(u=>{r.hide(),t.oops()})};return e.jsx(e.Fragment,{children:e.jsxs("main",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{children:e.jsx("span",{className:"text-2xl font-semibold",children:"Sign up"})}),e.jsx("div",{children:e.jsx("span",{className:"text-base text-gray-400",children:"create a strong password"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(y,{label:"Password",placeholder:"Password",errorMessage:c,type:g?"text":"password",value:l,onChange:d,autoFocus:!0,children:f}),e.jsx(z,{color:"dark",value:g,label:"Show password",onChange:o=>p(o.target.checked)})]}),e.jsx(k,{type:"dark",onClick:j,children:"Next"})]})})},ve=()=>e.jsx(e.Fragment,{children:e.jsx(X,{children:e.jsx(ue,{children:e.jsx(D,{})})})}),Ne=J([{id:"signup.root",path:"/",element:e.jsx(ve,{}),errorElement:e.jsx(me,{}),children:[{id:"signup",path:"/signup",element:e.jsx(ce,{}),children:[{id:"signup.username",path:"/signup",element:e.jsx(he,{})},{id:"signup.person",path:"/signup/person",element:e.jsx(ge,{})},{id:"signup.contact",path:"/signup/contact",element:e.jsx(pe,{})},{id:"signup.secret",path:"/signup/secret",element:e.jsx(je,{})}]}]}]),L=document.getElementById("p-signup");L&&K(L).render(e.jsx(Q,{router:Ne}));
